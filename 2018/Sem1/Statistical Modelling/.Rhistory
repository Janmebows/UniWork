costheta = (u%*%v)/(norm(u,"2")*norm(v,"2"))
thetarad = acos(costheta)
thetadeg = 180*thetarad/pi
thetadeg
costheta
library(readxl)
library("dplyr")
###Q6----
Num = read_xlsx('catheter.xlsx');
Height = pull(Num[,2])
Weight = pull(Num[,3])
#a is the first column of L1 and L2
#calculate span of L1 & L2
a  = array(1,12)
b1 = Height
b2 = Weight
#Using span to calculate projection vectors
projection1 = (a%*%b1/(norm(a,"2")^2))%*%a
projection2 = (a%*%b2/(norm(a,"2")^2))%*%a
u = as.vector(b1 - projection1)
v = as.vector(b2 - projection2)
#Calculating the angle between spaces
costheta = (u%*%v)/(norm(u,"2")*norm(v,"2"))
thetarad = acos(costheta)
thetadeg = 180*thetarad/pi
thetadeg
setwd("~/Uni/2018/Statistical Modelling")
# GROUP PROJECT
# Set working directory
#setwd("~/Documents/University/Third Year/Semester 1/Statistical Modelling/Group Project")
# Load useful packages
library(tidyverse)
library(ggplot2)
library(readxl)
library(MASS)
library(GGally)
# PART A - MULTIPLE LINEAR REGRESSION
# (1)
catheter <- read_excel("catheter.xlsx") # read the data into r
catheter$Child <- NULL # remove the variable Child as it does not contain any relevant information
pairs(catheter[,c("Length","Height","Weight")]) # create a pairwise scatterplot matrix
round(cor(catheter[,c("Length","Height","Weight")]),3) # create a correlation matrix
ggpairs(catheter[,c("Length","Height","Weight")])
# (2)
catheter.lm1 <- lm(Length~Height+Weight, data=catheter) # multiple linear regression model
catheter.lm2 <- lm(Length~Weight+Height, data=catheter) # multiple linear regression model
catheter.lm3 <- lm(Length~Height, data=catheter) # simple linear regression model
catheter.lm4 <- lm(Length~Weight, data=catheter) # simple linear regression model
# (3) - not done in R
# (4)
par(mfrow=c(2,2))
plot(catheter.lm1)
par(mfrow=c(1,1))
catheter$studres <- studres(catheter.lm1)
with(catheter,plot(Height,studres,pch=20,pty="s",ylab="Studentised Residuals", main = "Studentised Residuals vs Height"))
abline(0,0,col="red")
with(catheter,plot(Weight,studres,pch=20,ylab="Studentised Residuals", main = "Studentised Residuals vs Weight"))
abline(0,0,col="red")
with(catheter,plot(Length,studres,pch=20,ylab="Studentised Residuals", main = "Studentised Residuals vs Severity"))
abline(0,0,col="red")
summary(catheter.lm1)
summary(catheter.lm2)
summary(catheter.lm3)
summary(catheter.lm4)
# (5) - not done in R
# (6) - not done in R
# (7)
# Final model includes Weight only
# Clearly the multiple linear regression shouldn't be used
# Weight is more highly correlated to Length than Height is to Length and the assumptions for model checking are much better
# Assumption checking for final model
par(mfrow=c(2,2))
plot(catheter.lm4)
catheter$studres <- studres(catheter.lm4)
with(catheter,plot(Height,studres,pch=20,pty="s",ylab="Studentised Residuals", main = "Studentised Residuals vs Height"))
abline(0,0,col="red")
with(catheter,plot(Weight,studres,pch=20,ylab="Studentised Residuals", main = "Studentised Residuals vs Weight"))
abline(0,0,col="red")
with(catheter,plot(Length,studres,pch=20,ylab="Studentised Residuals", main = "Studentised Residuals vs Severity"))
abline(0,0,col="red")
summary(catheter.lm1)
summary(catheter.lm3)
summary(catheter.lm4)
setwd("~/Uni/2018/Statistical Modelling")
# Set working directory
#setwd("~/Documents/University/Third Year/Semester 1/Statistical Modelling/Group Project")
# Load useful packages
library(tidyverse)
library(ggplot2)
library(readxl)
library(MASS)
library(GGally)
### INTRODUCTION (DESCRIPTION OF DATA AND PURPOSE OF ANALYSIS)
# not done in R
### DATA ENTRY AND DATA CLEANING
mammo <- read.csv("mammo.txt") # reads the data into R
mammo$BI.RADS <- NULL # removes the variable BI.rads as it is excluded from our analysis
# Cleaning the Age variable
table(mammo$Age) # there are 5 missing entries
mammo$Age[mammo$Age == "?"] <- NA # sets the missing entries to NA
table(mammo$Age) # checks that the missing entries are now NA
class(mammo$Age) # the class is "factor" and so needs to be changed
mammo$Age <- as.numeric(as.character(mammo$Age)) # sets class to be "numeric" it is necessary to use character first so values align
class(mammo$Age) # checks that the class has been changed
table(mammo$Age)
# Cleaning the Shape variable
table(mammo$Shape) # there are 31 missing entries
mammo$Shape[mammo$Shape == "?"] <- NA # sets the missing entries to NA
table(mammo$Shape) # checks that the missing entries are now NA
class(mammo$Shape) # the class is "factor" and so doesn't need to be changed
mammo$Shape <- droplevels(mammo$Shape) # removes the empty "?" level
table(mammo$Shape) # checks that the empty "?" level has been removed
# Cleaning the Margin variable
table(mammo$Margin) # there are 48 missing entries
mammo$Margin[mammo$Margin == "?"] <- NA # sets the missing entries to NA
table(mammo$Margin) # checks that the missing entries are now NA
class(mammo$Margin) # the class is "factor" and so doesn't need to be changed
mammo$Margin <- droplevels(mammo$Margin) # removes the empty "?" level
table(mammo$Margin) # checks that the empty "?" level has been removed
# Cleaning the Density variable
table(mammo$Density) # there are 76 missing entries
mammo$Density[mammo$Density == "?"] <- NA # sets the missing entries to NA
table(mammo$Density) # checks that the missing entries are now NA
class(mammo$Density) # the class is "factor" and so doesn't need to be changed
mammo$Density <- droplevels(mammo$Density) # removes the empty "?" level
table(mammo$Density) # checks that the empty "?" level has been removed
# Cleaning the Severity variable
table(mammo$Severity) # there are no missing entries
class(mammo$Severity) # the class is "integer" so this needs to be changed
mammo$Severity <- as.factor(mammo$Severity) # sets class to be "factor"
class(mammo$Severity) # checks that the class has been changed
table(mammo$Severity)
### DATA VISUALISATION AND DATA SUMMARIES
# to create a correlation matrix all variables must be classed as numeric
mammo$Shape <- as.numeric(mammo$Shape)
mammo$Margin <- as.numeric(mammo$Margin)
mammo$Density <- as.numeric(mammo$Density)
mammo$Severity <- as.numeric(as.character(mammo$Severity))
table(mammo$Severity)
cor(mammo, use = "complete.obs") # creates a correlation matrix accounting for NA values
ggpairs(mammo, use = "complete.obs")
# reclassify the necessary variables
mammo$Shape <- as.factor(mammo$Shape)
mammo$Margin <- as.factor(mammo$Margin)
mammo$Density <- as.factor(mammo$Density)
mammo$Severity <- as.factor(mammo$Severity)
# summary statistics for each individual variable
summary(mammo$Age)
summary(mammo$Shape)
summary(mammo$Margin)
summary(mammo$Density)
summary(mammo$Severity)
# summary tables for each predictor variable against Severity
with(mammo, table(Severity, Age))
with(mammo, table(Severity, Shape))
with(mammo, table(Severity, Density))
with(mammo, table(Severity, Margin))
plot(mammo[,c("Severity","Age","Shape","Margin","Density")]) # create a pariwise scatterplot matrix
# Box-plots
ggplot(data=mammo, aes(Severity, Age)) + geom_boxplot() + labs(x= "Severity", y="Age (in years)")
ggplot(data=mammo, aes(Shape, Age, fill = Severity)) + geom_boxplot(na.rm = TRUE)
ggplot(data=mammo, aes(Density, Age, fill = Severity)) + geom_boxplot()
ggplot(data=mammo, aes(Margin, Age, fill = Severity)) + geom_boxplot()
# Other plots
plot(mammo$Age, mammo$Severity, xlab = "Age (in years)", ylab = "Severity")
plot(mammo$Shape, mammo$Severity, data=mammo, xlab = "Shape", ylab = "Severity")
plot(mammo$Margin, mammo$Severity, data=mammo, xlab = "Margin", ylab = "Severity")
plot(mammo$Density, mammo$Severity, data=mammo, xlab = "Density", ylab = "Severity")
### MODEL FITTING AND SELECTION
mammo.glm <- glm(Severity ~ (Age + Shape + Margin + Density)^2, data=mammo, family = "binomial")
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Shape:Density) # Get rid of this interactions as there are NA values
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Margin:Density) # Get rid of this interaction as there are NA values
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Margin) # Highest P value is 0.9898
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Shape:Margin) # Highest P value is 0.98932
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Density) # Highest P value is 0.7958
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Shape) # Highest P value is 0.7958
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Density)
summary(mammo.glm) # Final model includes Age, Shape, and Margin
### JUSTIFICATION FOR CHOICE OF FINAL MODEL
# not done in r
### INTERPRETATION OF PARAMETERS FROM FINAL MODEL
# not done in r
### PREDICTING PROBABILITIES AND INTERPRETATION
# The below give the probabilities of Severity = 1, i.e. probability of cancer.
# Have only chosen a few probabilities.
# Age
newdata1 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "4")) # mean age
predict(mammo.glm, newdata1, type = "response")
newdata2 <- with(mammo, data.frame(Age = 18, Shape = "1", Margin = "4")) # min age
predict(mammo.glm, newdata2, type = "response")
newdata3 <- with(mammo, data.frame(Age = 96, Shape = "1", Margin = "4")) # max age
predict(mammo.glm, newdata3, type = "response")
# Shape
newdata4 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "1")) # round
predict(mammo.glm, newdata4, type = "response")
newdata5 <- with(mammo, data.frame(Age = 55, Shape = "2", Margin = "1")) # oval
predict(mammo.glm, newdata5, type = "response")
newdata6 <- with(mammo, data.frame(Age = 55, Shape = "3", Margin = "1")) # lobular
predict(mammo.glm, newdata6, type = "response")
newdata7 <- with(mammo, data.frame(Age = 55, Shape = "4", Margin = "1")) # irregular
predict(mammo.glm, newdata7, type = "response")
# Margin
newdata8 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "1")) # circumscribed
predict(mammo.glm, newdata8, type = "response")
newdata9 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "2")) # microlobulated
predict(mammo.glm, newdata9, type = "response")
newdata10 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "3")) # obscured
predict(mammo.glm, newdata10, type = "response")
newdata11 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "4")) # ill-defined
predict(mammo.glm, newdata11, type = "response")
newdata12 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "5")) # spiculated
predict(mammo.glm, newdata12, type = "response")
# Set working directory
#setwd("~/Documents/University/Third Year/Semester 1/Statistical Modelling/Group Project")
# Load useful packages
library(tidyverse)
library(ggplot2)
library(readxl)
library(MASS)
library(GGally)
### INTRODUCTION (DESCRIPTION OF DATA AND PURPOSE OF ANALYSIS)
# not done in R
### DATA ENTRY AND DATA CLEANING
mammo <- read.csv("mammo.txt") # reads the data into R
mammo$BI.RADS <- NULL # removes the variable BI.rads as it is excluded from our analysis
# Cleaning the Age variable
table(mammo$Age) # there are 5 missing entries
mammo$Age[mammo$Age == "?"] <- NA # sets the missing entries to NA
table(mammo$Age) # checks that the missing entries are now NA
class(mammo$Age) # the class is "factor" and so needs to be changed
mammo$Age <- as.numeric(as.character(mammo$Age)) # sets class to be "numeric" it is necessary to use character first so values align
class(mammo$Age) # checks that the class has been changed
table(mammo$Age)
# Cleaning the Shape variable
table(mammo$Shape) # there are 31 missing entries
mammo$Shape[mammo$Shape == "?"] <- NA # sets the missing entries to NA
table(mammo$Shape) # checks that the missing entries are now NA
class(mammo$Shape) # the class is "factor" and so doesn't need to be changed
mammo$Shape <- droplevels(mammo$Shape) # removes the empty "?" level
table(mammo$Shape) # checks that the empty "?" level has been removed
# Cleaning the Margin variable
table(mammo$Margin) # there are 48 missing entries
mammo$Margin[mammo$Margin == "?"] <- NA # sets the missing entries to NA
table(mammo$Margin) # checks that the missing entries are now NA
class(mammo$Margin) # the class is "factor" and so doesn't need to be changed
mammo$Margin <- droplevels(mammo$Margin) # removes the empty "?" level
table(mammo$Margin) # checks that the empty "?" level has been removed
# Cleaning the Density variable
table(mammo$Density) # there are 76 missing entries
mammo$Density[mammo$Density == "?"] <- NA # sets the missing entries to NA
table(mammo$Density) # checks that the missing entries are now NA
class(mammo$Density) # the class is "factor" and so doesn't need to be changed
mammo$Density <- droplevels(mammo$Density) # removes the empty "?" level
table(mammo$Density) # checks that the empty "?" level has been removed
# Cleaning the Severity variable
table(mammo$Severity) # there are no missing entries
class(mammo$Severity) # the class is "integer" so this needs to be changed
mammo$Severity <- as.factor(mammo$Severity) # sets class to be "factor"
class(mammo$Severity) # checks that the class has been changed
table(mammo$Severity)
### DATA VISUALISATION AND DATA SUMMARIES
# to create a correlation matrix all variables must be classed as numeric
mammo$Shape <- as.numeric(mammo$Shape)
mammo$Margin <- as.numeric(mammo$Margin)
mammo$Density <- as.numeric(mammo$Density)
mammo$Severity <- as.numeric(as.character(mammo$Severity))
table(mammo$Severity)
cor(mammo, use = "complete.obs") # creates a correlation matrix accounting for NA values
ggpairs(mammo, use = "complete.obs")
# reclassify the necessary variables
mammo$Shape <- as.factor(mammo$Shape)
mammo$Margin <- as.factor(mammo$Margin)
mammo$Density <- as.factor(mammo$Density)
mammo$Severity <- as.factor(mammo$Severity)
# summary statistics for each individual variable
summary(mammo$Age)
summary(mammo$Shape)
summary(mammo$Margin)
summary(mammo$Density)
summary(mammo$Severity)
# summary tables for each predictor variable against Severity
with(mammo, table(Severity, Age))
with(mammo, table(Severity, Shape))
with(mammo, table(Severity, Density))
with(mammo, table(Severity, Margin))
plot(mammo[,c("Severity","Age","Shape","Margin","Density")]) # create a pariwise scatterplot matrix
# Box-plots
ggplot(data=mammo, aes(Severity, Age)) + geom_boxplot() + labs(x= "Severity", y="Age (in years)")
ggplot(data=mammo, aes(Shape, Age, fill = Severity)) + geom_boxplot(na.rm = TRUE)
ggplot(data=mammo, aes(Density, Age, fill = Severity)) + geom_boxplot()
ggplot(data=mammo, aes(Margin, Age, fill = Severity)) + geom_boxplot()
# Other plots
plot(mammo$Age, mammo$Severity, xlab = "Age (in years)", ylab = "Severity")
plot(mammo$Shape, mammo$Severity, data=mammo, xlab = "Shape", ylab = "Severity")
plot(mammo$Margin, mammo$Severity, data=mammo, xlab = "Margin", ylab = "Severity")
plot(mammo$Density, mammo$Severity, data=mammo, xlab = "Density", ylab = "Severity")
### MODEL FITTING AND SELECTION
mammo.glm <- glm(Severity ~ (Age + Shape + Margin + Density)^2, data=mammo, family = "binomial")
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Shape:Density) # Get rid of this interactions as there are NA values
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Margin:Density) # Get rid of this interaction as there are NA values
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Margin) # Highest P value is 0.9898
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Shape:Margin) # Highest P value is 0.98932
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Density) # Highest P value is 0.7958
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Shape) # Highest P value is 0.7958
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Density)
summary(mammo.glm) # Final model includes Age, Shape, and Margin
### JUSTIFICATION FOR CHOICE OF FINAL MODEL
# not done in r
### INTERPRETATION OF PARAMETERS FROM FINAL MODEL
# not done in r
### PREDICTING PROBABILITIES AND INTERPRETATION
# The below give the probabilities of Severity = 1, i.e. probability of cancer.
# Have only chosen a few probabilities.
# Age
newdata1 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "4")) # mean age
predict(mammo.glm, newdata1, type = "response")
newdata2 <- with(mammo, data.frame(Age = 18, Shape = "1", Margin = "4")) # min age
predict(mammo.glm, newdata2, type = "response")
newdata3 <- with(mammo, data.frame(Age = 96, Shape = "1", Margin = "4")) # max age
predict(mammo.glm, newdata3, type = "response")
# Shape
newdata4 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "1")) # round
predict(mammo.glm, newdata4, type = "response")
newdata5 <- with(mammo, data.frame(Age = 55, Shape = "2", Margin = "1")) # oval
predict(mammo.glm, newdata5, type = "response")
newdata6 <- with(mammo, data.frame(Age = 55, Shape = "3", Margin = "1")) # lobular
predict(mammo.glm, newdata6, type = "response")
newdata7 <- with(mammo, data.frame(Age = 55, Shape = "4", Margin = "1")) # irregular
predict(mammo.glm, newdata7, type = "response")
# Margin
newdata8 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "1")) # circumscribed
predict(mammo.glm, newdata8, type = "response")
newdata9 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "2")) # microlobulated
predict(mammo.glm, newdata9, type = "response")
newdata10 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "3")) # obscured
predict(mammo.glm, newdata10, type = "response")
newdata11 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "4")) # ill-defined
predict(mammo.glm, newdata11, type = "response")
newdata12 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "5")) # spiculated
predict(mammo.glm, newdata12, type = "response")
summary(mammo.glm)
tmp = par(mfrow(c(2,2)))
plot(mammo.glm)
par(tmp)
tmp = par(mfrow=c(2,2))
plot(mammo.glm)
# Set working directory
#setwd("~/Documents/University/Third Year/Semester 1/Statistical Modelling/Group Project")
# Load useful packages
library(tidyverse)
library(ggplot2)
library(readxl)
library(MASS)
library(GGally)
### INTRODUCTION (DESCRIPTION OF DATA AND PURPOSE OF ANALYSIS)
# not done in R
### DATA ENTRY AND DATA CLEANING
mammo <- read.csv("mammo.txt") # reads the data into R
mammo$BI.RADS <- NULL # removes the variable BI.rads as it is excluded from our analysis
# Cleaning the Age variable
table(mammo$Age) # there are 5 missing entries
mammo$Age[mammo$Age == "?"] <- NA # sets the missing entries to NA
table(mammo$Age) # checks that the missing entries are now NA
class(mammo$Age) # the class is "factor" and so needs to be changed
mammo$Age <- as.numeric(as.character(mammo$Age)) # sets class to be "numeric" it is necessary to use character first so values align
class(mammo$Age) # checks that the class has been changed
table(mammo$Age)
# Cleaning the Shape variable
table(mammo$Shape) # there are 31 missing entries
mammo$Shape[mammo$Shape == "?"] <- NA # sets the missing entries to NA
table(mammo$Shape) # checks that the missing entries are now NA
class(mammo$Shape) # the class is "factor" and so doesn't need to be changed
mammo$Shape <- droplevels(mammo$Shape) # removes the empty "?" level
table(mammo$Shape) # checks that the empty "?" level has been removed
# Cleaning the Margin variable
table(mammo$Margin) # there are 48 missing entries
mammo$Margin[mammo$Margin == "?"] <- NA # sets the missing entries to NA
table(mammo$Margin) # checks that the missing entries are now NA
class(mammo$Margin) # the class is "factor" and so doesn't need to be changed
mammo$Margin <- droplevels(mammo$Margin) # removes the empty "?" level
table(mammo$Margin) # checks that the empty "?" level has been removed
# Cleaning the Density variable
table(mammo$Density) # there are 76 missing entries
mammo$Density[mammo$Density == "?"] <- NA # sets the missing entries to NA
table(mammo$Density) # checks that the missing entries are now NA
class(mammo$Density) # the class is "factor" and so doesn't need to be changed
mammo$Density <- droplevels(mammo$Density) # removes the empty "?" level
table(mammo$Density) # checks that the empty "?" level has been removed
# Cleaning the Severity variable
table(mammo$Severity) # there are no missing entries
class(mammo$Severity) # the class is "integer" so this needs to be changed
mammo$Severity <- as.factor(mammo$Severity) # sets class to be "factor"
class(mammo$Severity) # checks that the class has been changed
table(mammo$Severity)
### DATA VISUALISATION AND DATA SUMMARIES
# to create a correlation matrix all variables must be classed as numeric
mammo$Shape <- as.numeric(mammo$Shape)
mammo$Margin <- as.numeric(mammo$Margin)
mammo$Density <- as.numeric(mammo$Density)
mammo$Severity <- as.numeric(as.character(mammo$Severity))
table(mammo$Severity)
cor(mammo, use = "complete.obs") # creates a correlation matrix accounting for NA values
ggpairs(mammo, use = "complete.obs")
# reclassify the necessary variables
mammo$Shape <- as.factor(mammo$Shape)
mammo$Margin <- as.factor(mammo$Margin)
mammo$Density <- as.factor(mammo$Density)
mammo$Severity <- as.factor(mammo$Severity)
# summary statistics for each individual variable
summary(mammo$Age)
summary(mammo$Shape)
summary(mammo$Margin)
summary(mammo$Density)
summary(mammo$Severity)
# summary tables for each predictor variable against Severity
with(mammo, table(Severity, Age))
with(mammo, table(Severity, Shape))
with(mammo, table(Severity, Density))
with(mammo, table(Severity, Margin))
plot(mammo[,c("Severity","Age","Shape","Margin","Density")]) # create a pariwise scatterplot matrix
# Box-plots
ggplot(data=mammo, aes(Severity, Age)) + geom_boxplot() + labs(x= "Severity", y="Age (in years)")
ggplot(data=mammo, aes(Shape, Age, fill = Severity)) + geom_boxplot(na.rm = TRUE)
ggplot(data=mammo, aes(Density, Age, fill = Severity)) + geom_boxplot()
ggplot(data=mammo, aes(Margin, Age, fill = Severity)) + geom_boxplot()
# Other plots
plot(mammo$Age, mammo$Severity, xlab = "Age (in years)", ylab = "Severity")
plot(mammo$Shape, mammo$Severity, data=mammo, xlab = "Shape", ylab = "Severity")
plot(mammo$Margin, mammo$Severity, data=mammo, xlab = "Margin", ylab = "Severity")
plot(mammo$Density, mammo$Severity, data=mammo, xlab = "Density", ylab = "Severity")
### MODEL FITTING AND SELECTION
mammo.glm <- glm(Severity ~ (Age + Shape + Margin + Density)^2, data=mammo, family = "binomial")
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Shape:Density) # Get rid of this interactions as there are NA values
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Margin:Density) # Get rid of this interaction as there are NA values
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Margin) # Highest P value is 0.9898
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Shape:Margin) # Highest P value is 0.98932
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Density) # Highest P value is 0.7958
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Age:Shape) # Highest P value is 0.7958
summary(mammo.glm)
mammo.glm <- update(mammo.glm, .~. -Density)
summary(mammo.glm) # Final model includes Age, Shape, and Margin
tmp = par(mfrow=c(2,2))
plot(mammo.glm)
par(tmp)
### JUSTIFICATION FOR CHOICE OF FINAL MODEL
# not done in r
### INTERPRETATION OF PARAMETERS FROM FINAL MODEL
# not done in r
### PREDICTING PROBABILITIES AND INTERPRETATION
# The below give the probabilities of Severity = 1, i.e. probability of cancer.
# Have only chosen a few probabilities.
# Age
newdata1 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "4")) # mean age
predict(mammo.glm, newdata1, type = "response")
newdata2 <- with(mammo, data.frame(Age = 18, Shape = "1", Margin = "4")) # min age
predict(mammo.glm, newdata2, type = "response")
newdata3 <- with(mammo, data.frame(Age = 96, Shape = "1", Margin = "4")) # max age
predict(mammo.glm, newdata3, type = "response")
# Shape
newdata4 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "1")) # round
predict(mammo.glm, newdata4, type = "response")
newdata5 <- with(mammo, data.frame(Age = 55, Shape = "2", Margin = "1")) # oval
predict(mammo.glm, newdata5, type = "response")
newdata6 <- with(mammo, data.frame(Age = 55, Shape = "3", Margin = "1")) # lobular
predict(mammo.glm, newdata6, type = "response")
newdata7 <- with(mammo, data.frame(Age = 55, Shape = "4", Margin = "1")) # irregular
predict(mammo.glm, newdata7, type = "response")
# Margin
newdata8 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "1")) # circumscribed
predict(mammo.glm, newdata8, type = "response")
newdata9 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "2")) # microlobulated
predict(mammo.glm, newdata9, type = "response")
newdata10 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "3")) # obscured
predict(mammo.glm, newdata10, type = "response")
newdata11 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "4")) # ill-defined
predict(mammo.glm, newdata11, type = "response")
newdata12 <- with(mammo, data.frame(Age = 55, Shape = "1", Margin = "5")) # spiculated
predict(mammo.glm, newdata12, type = "response")
tmp = par(mfrow=c(2,2))
plot(mammo.glm)
par(tmp)
summary(mammo)
summary(mammo.glm)
plot(catheter.lm4)
par(mfrow=c(2,2))
catheter$studres <- studres(catheter.lm4)
with(catheter,plot(Height,studres,pch=20,pty="s",ylab="Studentised Residuals", main = "Studentised Residuals vs Height"))
abline(0,0,col="red")
with(catheter,plot(Weight,studres,pch=20,ylab="Studentised Residuals", main = "Studentised Residuals vs Weight"))
abline(0,0,col="red")
with(catheter,plot(Length,studres,pch=20,ylab="Studentised Residuals", main = "Studentised Residuals vs Severity"))
abline(0,0,col="red")
