Y[0] = Z[0]
Y[t] = sqrt(1-1/(t)^2) * Y[t-1] + 1/(t) * Z[t]
1-1/t
length(1-1/t)
length(Y[t-1])
Y[t-1]
Y[t] = sqrt(1-1/(t)^2)  + 1/(t) * Z[t]
Y[0] = Z[0]
Y = vector(mode ="double", length = 1000)
Y[0] = Z[0]
t2 = seq(0,999,1)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[0] = Z[0]
Y[t] = sqrt(1-1/(t)^2) * Y[t2] + 1/(t) * Z[t]
plot(Y)
length(t2)
length(t)
Y[t2]
Y[0]
Y[1]
t[0]
t = seq(2,1000,1)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y
Y[1] = Z[1]
Y[t] = sqrt(1-(1/(t)^2)) * Y[t-1] + 1/(t) * Z[t]
plot(ts(Y))
Y[t] = sqrt(1-(1/(t^2))) * Y[t-1] + 1/(t) * Z[t]
t = seq(2,1000,1)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
Y[t] = sqrt(1-(1/(t^2))) * Y[t-1] + 1/(t) * Z[t]
plot(ts(Y))
for (i in 1:100){
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
Y[t] = sqrt(1-1/(t)^2) * Y[t-1] + 1/(t) * Z[t]
#plotting each y set with a different colour
lines(ts(Y), col=rgb(runif(1,min=0,max=1),runif(1,min=0,max=1),runif(1,min=0,max=1),1))
}
t = seq(2,1000,1)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
Y[t] = sqrt(1-(1/(t^2))) * Y[t-1] + (1/t) * Z[t]
plot(ts(Y))
for (i in 1:100){
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
Y[t] = sqrt(1-(1/(t^2))) * Y[t-1] + (1/t) * Z[t]
#plotting each y set with a different colour
lines(ts(Y), col=rgb(runif(1,min=0,max=1),runif(1,min=0,max=1),runif(1,min=0,max=1),1))
}
?rnorm
t = seq(2,1000,1)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
Y[t] = (sqrt(1-(1/(t^2))) * Y[t-1]) + ((1/t) * Z[t])
plot(ts(Y))
Y = vector(mode ="double", length = 1000)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
plot(ts(Y))
Y[t] = (sqrt(1-(1/(t^2))) * Y[t-1]) + ((1/t) * Z[t])
plot(NULL, xlim=c(0,1000), ylim=c(-1,1), ylab="Y", xlab="Time")
for (i in 1:100){
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
Y[1] = Z[1]
Y[t] = (sqrt(1-(1/(t^2))) * Y[t-1]) + ((1/t) * Z[t])
#plotting each y set with a different colour
lines(ts(Y), col=rgb(runif(1,min=0,max=1),runif(1,min=0,max=1),runif(1,min=0,max=1),1))
}
edit(Y)
i
t = seq(2,1000,1)
Z = rnorm(1000,0,1)
Y = vector(mode ="double", length = 1000)
t
z
Z
for (i in 2:1000){
Y[i] = (sqrt(1-(1/(i^2))) * Y[i-1]) + ((1/i) * Z[i])
}
plot(ts(Y))
?noise
arima.sim()
arima.sim(200)
help arima
?arima
AR(1)
clc
cls
clear
arima(x)
x = rnorm(200)
arima(x)
x = rnorm(200)
arima(x)
arima(x)
tmp = par(mfrow=c(2,3))
data(co2)
times=time(co2)
month=factor(rep(c("jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"),39))
lm.seasonal=lm(co2~month+times+I(times^2)+I(times^3))
res=co2-fitted(lm.seasonal)
plot(res)
par(tmp)
res=co2-fitted(lm.seasonal)
par(mfrow=c(1,1))
data(co2)
times=time(co2)
month=factor(rep(c("jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"),39))
lm.seasonal=lm(co2~month+times+I(times^2)+I(times^3))
res=co2-fitted(lm.seasonal)
res=co2-fitted(lm.seasonal)
plot(res)
x=c(1:512)/512
ts(x)
plot(ts(x))
spectrum(x)
spectrum(ts(x))
?spectrum
plot(x,log="yes")
spectrum(x,log=yes)
spectrum(x,log="yes")
x=c(1:512)/512
x=c(1:512)/512
x = ts(x)
plot(x)
??periodogram
y = cos(2*pi*x)
y.spectrum = spectrum(y, plot=F)
y.spec = y.spectrum$spec
y.freq = y.spectrum$freq
y.spectrum = spectrum(y, plot=F)
spectrum(x,plot=F)
spectrum(x,log="no", detrend="F")
spectrum(x,log="yes", detrend="F")
spectrum(x,log="no", detrend="F")
spectrum(x,log="yes", detrend="F")
spectrum(x,log="YES", detrend="T")
spectrum(x,log="yes", detrend="T")
spectrum(x,log="no", detrend="T")
?spectrum
spectrum(x,log="no", detrend="F")
spectrum(x,log="yes", detrend="F")
y.spectrum = spectrum(y, plot=T)
y.spectrum = spectrum(y, plot=F)
y.freq = y.spectrum$freq
y.spec = y.spectrum$spec
plot(y.spec,y.freq)
y = cos(2*pi*x)
y=ts(y)
spectrum(y)
spectrum(y,log="no")
y = cos(2*pi*x)
y=ts(y)
spectrum(y,log="no")
spectrum(y,log="yes")
y = sin(2*pi*x)+cos(20*pi*x)
y=ts(y)
spectrum(y,log="no")
spectrum(y,log="yes")
u=rnorm(512)
u=ts(u)
plot(u)
spectrum(u,log="no")
spectrum(u,log="yes")
z = y+u
z=ts(z)
spectrum(z,log="no")
spectrum(z,log="yes")
ldeaths = ldeaths
acf(ldeaths)
plot(ldeaths)
spectrum(ldeaths)
acf(ldeaths)
cpgramm(ldeaths)
cpgram(ldeaths)
spectrum(ldeaths,log="no")
spectrum(ldeaths)
spectrum(ldeaths,log="no")
deltat(ldeaths)
1/12
spectrum(ldeaths,log="no")
cpgram(ldeaths)
spectrum(ldeaths,log="no")
cpgram(ldeaths)
z = rnorm(1001)
y = rep(0,1001)
b=0.5
for(i in 2:1000) y[i]=z[i]+b*z[i-1]
y=y[-1]
y=ts(y)
z = rnorm(1001)
y = rep(0,1001)
b=0.95
for(i in 2:1000) y[i]=z[i]+b*z[i-1]
y=y[-1]
y=ts(y)
acf(y)
cpgram(y)
spectrum(y)
cpgram(y)
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
y=ts(y[10001:20000])
plot(y)
plot(y)
z=rnorm(2000)
y=rep(0,2000)
a=0.5
for(i in 2:2000) y[i]=a*y[i-1]+z[i]
y=ts(y[1001:2000])
plot(y)
ldeaths = ldeaths
plot(ldeaths)
spectrum(ldeaths)
acf(ldeaths)
cpgram(ldeaths)
spectrum(ldeaths,log="no")
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
y=ts(y[10001:20000])
plot(y)
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
ts(y)
plot(ts(y))
y=ts(y[10001:20000])
plot(y)
acf(y)
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
acf(ts(y))
acf(y)
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
y=ts(y[10001:20000])
plot(y)
acf(y)
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
y=ts(y[10001:20000])
plot(y)
acf(y)
spectrum(y)
cpgram(y)
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
y=ts(y[1001:20000])
plot(y)
acf(y)
spectrum(y)
cpgram(y)
acf(y)
z=rnorm(20000)
y=rep(0,20000)
a=0.9
for(i in 2:20000) y[i]=a*y[i-1]+z[i]
y=ts(y[1001:20000])
plot(y)
acf(y)
z=rnorm(2000)
y=rep(0,2000)
for(i in 3:2000) y[i]=-0.5*y[i-1] + 0.505*y[i-2]+z[i]
y=ts(y[1001:2000])
plot(y)
z=rnorm(2000)
y=rep(0,2000)
a=0.5
for(i in 3:2000) y[i]=-0.5*y[i-1] + 0.505*y[i-2]+z[i]
y=ts(y[1001:2000])
plot(y)
acf(y)
z=rnorm(2000)
y=rep(0,2000)
a=0.5
for(i in 3:2000) y[i]=-0.5*y[i-1] + 0.505*y[i-2]+z[i]
plot(ts(y))
z=rnorm(2000)
y=rep(0,2000)
a=0.5
for(i in 3:2000) y[i]=-0.5*y[i-1] + 0.4*y[i-2]+z[i]
y=ts(y[1001:2000])
plot(y)
z=rnorm(2000)
y=rep(0,2000)
a=0.5
for(i in 3:2000) y[i]=-0.5*y[i-1] + 0.505*y[i-2]+z[i]
y=ts(y[1001:2000])
plot(y)
plot(y[1:100])
plot(ts(y[1:100])
)
?polyroot
polyroot([1,0.5,-0.505])
polyroot(c(1,0.5,-0.505)
polyroot(c(1,0.5,-0.505))
polyroot(c(1,0.5,-0.505))
polyroot(c(1,0.5,-0.4))
?arima.sim
arima.sim(2,2)
arima.sim(c(2,2))
arima.sim(n=10000,list(ar = 2, ma=2))
arima.sim(n=10000,list(ar = c(0.1,0.25), ma=c(0.5,0.5)))
plot(q6)
q6 = arima.sim(n=10000,list(ar = c(0.1,0.25), ma=c(0.5,0.5)))
plot(q6
plot(q6)
plot(q6)
z=rnorm(20000)
y=rep(0,20000)
for(t in 3:20000) Y[t] =- 0.5* Y[t-1] - 0.25*Y[t-2] + Z[t] + 0.5*Z[t-1] + 0.5*Z[t-2]
z=rnorm(20000)
Y=rep(0,20000)
for(t in 3:20000) Y[t] =- 0.5* Y[t-1] - 0.25*Y[t-2] + Z[t] + 0.5*Z[t-1] + 0.5*Z[t-2]
plot(ts(Y))
Y
z=rnorm(20000)
Y=rep(0,20000)
for(t in 3:20000) Y[t] =- 0.1* Y[t-1] - 0.25*Y[t-2] + Z[t] + 0.5*Z[t-1] + 0.5*Z[t-2]
plot(ts(Y))
Y = ts(Y[10001:20000])
plot(ts(Y))
plot(Y)
for(t in 3:20000) Y[t] =- 0.1* Y[t-1] - 0.25*Y[t-2] + Z[t] + 0.5*Z[t-1] + 0.5*Z[t-2]
Y = ts(Y[10001:20000])
plot(Y)
Z=rnorm(20000)
Y=rep(0,20000)
for(t in 3:20000) Y[t] =- 0.1* Y[t-1] - 0.25*Y[t-2] + Z[t] + 0.5*Z[t-1] + 0.5*Z[t-2]
Y = ts(Y[10001:20000])
plot(Y)
q6 = arima.sim(n=10000,list(ar = c(0.1,0.25), ma=c(0.5,0.5)))
plot(q6)
plot(Y)
plot(q6)
data(co2)
times=time(co2)
month=factor(rep(c("jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"),39))
lm.seasonal=lm(co2~month+times+I(times^2)+I(times^3))
res=co2-fitted(lm.seasonal)
?arima
?arima.sim
arima.sim(c(1,1,1))
arima.sim(n=200, list(ar=0.9))
AR11 = arima.sim(n=200, list(ar=0.9))
?ARIMA.SIM
ARIMA3=arima.sim(n=200, list(order=c(1,3,1),ar=c(0.8), ma=c(0.8)))
plot(ARIMA3)
class(ARIMA3)
library(MASS)
setwd("~/Uni/2018/Sem2/Time Series")
tmp = par(mfrow =c(2,2))
AR11 = arima.sim(n=200, list(ar=0.9))
plot(AR11)
spectrum(AR11)
pacf(AR11)
acf(AR11)
AR12 = arima.sim(n=200, list(ar=0.2))
plot(AR12)
spectrum(AR12)
acf(AR12)
pacf(AR12)
AR13 = arima.sim(n=200, list(ar=-0.4))
plot(AR13)
spectrum(AR13)
acf(AR13)
pacf(AR13)
AR14 = arima.sim(n=200, list(ar=-0.8))
plot(AR14)
spectrum(AR14)
acf(AR14)
pacf(AR14)
library(MASS)
setwd("~/Uni/2018/Sem2/Time Series")
tmp = par(mfrow =c(2,2))
AR11 = arima.sim(n=200, list(ar=0.9))
plot(AR11)
spectrum(AR11)
acf(AR11)
pacf(AR11)
AR12 = arima.sim(n=200, list(ar=0.2))
plot(AR12)
spectrum(AR12)
acf(AR12)
pacf(AR12)
AR13 = arima.sim(n=200, list(ar=-0.4))
plot(AR13)
spectrum(AR13)
acf(AR13)
pacf(AR13)
AR14 = arima.sim(n=200, list(ar=-0.8))
plot(AR14)
spectrum(AR14)
acf(AR14)
pacf(AR14)
AR21 = arima.sim(n=200, list(ar=c(1,-0.5)))
plot(AR21)
spectrum(AR21)
acf(AR21)
pacf(AR21)
AR22 = arima.sim(n=200, list(ar=c(-1,-0.5)))
plot(AR22)
spectrum(AR22)
acf(AR22)
pacf(AR22)
AR23 = arima.sim(n=200, list(ar=c(0.25,0.5)))
plot(AR23)
spectrum(AR23)
acf(AR23)
pacf(AR23)
AR24 = arima.sim(n=200, list(ar=c(-0.25,0.5)))
plot(AR24)
spectrum(AR24)
acf(AR24)
pacf(AR24)
MA11 = arima.sim(n=200, list(ma=0.9))
plot(MA11)
spectrum(MA11)
acf(MA11)
pacf(MA11)
MA12 = arima.sim(n=200, list(ma=0.2))
plot(MA12)
spectrum(MA12)
acf(MA12)
pacf(MA12)
MA13 = arima.sim(n=200, list(ma=-0.4))
plot(MA13)
spectrum(MA13)
acf(MA13)
pacf(MA13)
MA14 = arima.sim(n=200, list(ma=-0.8))
plot(MA14)
spectrum(MA14)
acf(MA14)
pacf(MA14)
MA21 = arima.sim(n=200, list(ma=c(1,0.5)))
plot(MA21)
spectrum(MA21)
acf(MA21)
pacf(MA21)
MA22 = arima.sim(n=200, list(ma=c(-1,0.5)))
plot(MA22)
spectrum(MA22)
acf(MA22)
pacf(MA22)
MA23 = arima.sim(n=200, list(ma=c(0.25,-0.5)))
plot(MA23)
spectrum(MA23)
acf(MA23)
pacf(MA23)
MA24 = arima.sim(n=200, list(ma=c(-0.25,-0.5)))
plot(MA24)
spectrum(MA24)
acf(MA24)
pacf(MA24)
ARMA11=arima.sim(n=200, list(ar=c(0.8), ma=c(0.8)))
plot(ARMA11)
spectrum(ARMA11)
acf(ARMA11)
pacf(ARMA11)
ARMA12=arima.sim(n=200, list(ar=c(-0.8), ma=c(0.8)))
plot(ARMA12)
spectrum(ARMA12)
acf(ARMA12)
pacf(ARMA12)
ARMA13=arima.sim(n=200, list(ar=c(-0.8), ma=c(-0.8)))
plot(ARMA13)
spectrum(ARMA13)
acf(ARMA13)
pacf(ARMA13)
ARIMA1=arima.sim(n=200, list(order=c(1,1,1),ar=c(0.8), ma=c(0.8)))
plot(ARIMA1)
spectrum(ARIMA1)
acf(ARIMA1)
pacf(ARIMA1)
ARIMA2=arima.sim(n=200, list(order=c(1,2,1),ar=c(0.8), ma=c(0.8)))
plot(ARIMA2)
spectrum(ARIMA2)
acf(ARIMA2)
pacf(ARIMA2)
ARIMA3=arima.sim(n=200, list(order=c(1,3,1),ar=c(0.8), ma=c(0.8)))
plot(ARIMA3)
spectrum(ARIMA3)
acf(ARIMA3)
pacf(ARIMA3)
data(co2)
times=time(co2)
month=factor(rep(c("jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"),39))
lm.seasonal=lm(co2~month+times+I(times^2)+I(times^3))
res=co2-fitted(lm.seasonal)
